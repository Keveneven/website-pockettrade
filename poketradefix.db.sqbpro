<?xml version="1.0" encoding="UTF-8"?><sqlb_project><db path="poketrade.db.db" readonly="0" foreign_keys="1" case_sensitive_like="0" temp_store="0" wal_autocheckpoint="1000" synchronous="2"/><attached/><window><main_tabs open="structure browser pragmas query" current="0"/></window><tab_structure><column_width id="0" width="300"/><column_width id="1" width="0"/><column_width id="2" width="100"/><column_width id="3" width="4626"/><column_width id="4" width="0"/><expanded_item id="0" parent="1"/><expanded_item id="1" parent="0"/><expanded_item id="1" parent="1"/><expanded_item id="2" parent="1"/><expanded_item id="3" parent="1"/></tab_structure><tab_browse><table title="cards" custom_title="0" dock_id="7" table="4,5:maincards"/><dock_state state="000000ff00000000fd0000000100000002000005f4000002e6fc0100000003fb000000160064006f0063006b00420072006f00770073006500310100000000000005f40000000000000000fb000000160064006f0063006b00420072006f00770073006500360100000000000005f40000000000000000fb000000160064006f0063006b00420072006f00770073006500370100000000000005f40000011800ffffff000005f40000000000000004000000040000000800000008fc00000000"/><default_encoding codec=""/><browse_table_settings><table schema="main" name="card_price_snapshots" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="29"/><column index="2" value="52"/><column index="3" value="76"/><column index="4" value="69"/><column index="5" value="87"/><column index="6" value="81"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="cards" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="29"/><column index="2" value="45"/><column index="3" value="117"/><column index="4" value="82"/><column index="5" value="85"/><column index="6" value="300"/><column index="7" value="156"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="event_attendance" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="29"/><column index="2" value="59"/><column index="3" value="52"/><column index="4" value="70"/><column index="5" value="78"/><column index="6" value="156"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table></browse_table_settings></tab_browse><tab_sql><sql name="SQL 1*">-- ============================================================
-- POKETRADE SCHEMA MIGRATION (FIXED)
-- Adds all Pokemon TCG API fields to your database
-- Run this in DB Browser for SQLite BEFORE importing data
-- ============================================================

-- ============================================================
-- PART 1: ADD COLUMNS TO CARDS TABLE
-- ============================================================

-- Basic Info
ALTER TABLE cards ADD COLUMN api_id TEXT;              -- &quot;xy1-1&quot; (UNIQUE index added later)
ALTER TABLE cards ADD COLUMN supertype TEXT;           -- &quot;Pokémon&quot;, &quot;Trainer&quot;, &quot;Energy&quot;
ALTER TABLE cards ADD COLUMN hp TEXT;                  -- &quot;180&quot;
ALTER TABLE cards ADD COLUMN artist TEXT;              -- &quot;Eske Yoshinob&quot;

-- Evolves/Rules
ALTER TABLE cards ADD COLUMN evolves_to TEXT;          -- JSON array: [&quot;M Venusaur-EX&quot;]
ALTER TABLE cards ADD COLUMN evolves_from TEXT;        -- &quot;Ivysaur&quot;
ALTER TABLE cards ADD COLUMN rules TEXT;               -- JSON array of rules

-- Types/Subtypes (stored as JSON)
ALTER TABLE cards ADD COLUMN types TEXT;               -- JSON: [&quot;Grass&quot;]
ALTER TABLE cards ADD COLUMN subtypes TEXT;            -- JSON: [&quot;Basic&quot;, &quot;EX&quot;]

-- Combat Stats
ALTER TABLE cards ADD COLUMN attacks TEXT;             -- JSON array of attack objects
ALTER TABLE cards ADD COLUMN weaknesses TEXT;          -- JSON: [{&quot;type&quot;: &quot;Fire&quot;, &quot;value&quot;: &quot;×2&quot;}]
ALTER TABLE cards ADD COLUMN resistances TEXT;         -- JSON: [{&quot;type&quot;: &quot;Water&quot;, &quot;value&quot;: &quot;-20&quot;}]
ALTER TABLE cards ADD COLUMN retreat_cost TEXT;        -- JSON: [&quot;Colorless&quot;, &quot;Colorless&quot;]
ALTER TABLE cards ADD COLUMN converted_retreat_cost INTEGER; -- 4

-- Pokedex
ALTER TABLE cards ADD COLUMN national_pokedex_numbers TEXT; -- JSON: [3]

-- Legalities
ALTER TABLE cards ADD COLUMN legal_standard TEXT;      -- &quot;Legal&quot; or &quot;Banned&quot; or NULL
ALTER TABLE cards ADD COLUMN legal_expanded TEXT;      -- &quot;Legal&quot; or &quot;Banned&quot; or NULL
ALTER TABLE cards ADD COLUMN legal_unlimited TEXT;     -- &quot;Legal&quot; or &quot;Banned&quot; or NULL

-- Images (you already have image_url, adding more options)
ALTER TABLE cards ADD COLUMN image_small TEXT;         -- Small image URL
ALTER TABLE cards ADD COLUMN image_large TEXT;         -- Large/hires image URL

-- TCGPlayer Pricing Data
ALTER TABLE cards ADD COLUMN tcgplayer_url TEXT;       -- Direct buy link
ALTER TABLE cards ADD COLUMN tcgplayer_updated_at TEXT;-- Last price update
ALTER TABLE cards ADD COLUMN price_low REAL;           -- Lowest market price
ALTER TABLE cards ADD COLUMN price_mid REAL;           -- Mid market price
ALTER TABLE cards ADD COLUMN price_high REAL;          -- High market price
ALTER TABLE cards ADD COLUMN price_market REAL;        -- Current market price

-- Metadata
ALTER TABLE cards ADD COLUMN updated_at TEXT;          -- When card data was last updated

-- Now create UNIQUE index on api_id (this works on existing tables)
CREATE UNIQUE INDEX IF NOT EXISTS idx_cards_api_id ON cards(api_id);

-- ============================================================
-- PART 2: ADD COLUMNS TO SETS TABLE
-- ============================================================

ALTER TABLE sets ADD COLUMN printed_total INTEGER;     -- 146 (printed on cards)
ALTER TABLE sets ADD COLUMN total_cards INTEGER;       -- 146 (actual total)
ALTER TABLE sets ADD COLUMN ptcgo_code TEXT;           -- &quot;XY&quot; (online code)
ALTER TABLE sets ADD COLUMN legal_standard TEXT;       -- Set legality
ALTER TABLE sets ADD COLUMN legal_expanded TEXT;
ALTER TABLE sets ADD COLUMN legal_unlimited TEXT;
ALTER TABLE sets ADD COLUMN image_symbol TEXT;         -- Symbol image URL
ALTER TABLE sets ADD COLUMN image_logo TEXT;           -- Logo image URL
ALTER TABLE sets ADD COLUMN updated_at TEXT;           -- Last update timestamp

-- ============================================================
-- PART 3: VERIFICATION
-- ============================================================

-- Check cards table structure
SELECT 'CARDS TABLE COLUMNS:' as info;
PRAGMA table_info(cards);

-- Check sets table structure
SELECT 'SETS TABLE COLUMNS:' as info;
PRAGMA table_info(sets);

-- Count existing data
SELECT 'EXISTING DATA:' as info;
SELECT 
    (SELECT COUNT(*) FROM cards) as total_cards,
    (SELECT COUNT(*) FROM sets) as total_sets,
    (SELECT COUNT(*) FROM users) as total_users;

-- Success message
SELECT '✅ Schema migration completed successfully!' as status;</sql><current_tab id="0"/></tab_sql></sqlb_project>
